<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>페이지 이동 중...</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: #f5f5f5;
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
        }
        .loader {
            text-align: center;
            color: #666;
        }
        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid #e0e0e0;
            border-top-color: #03c75a;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin: 0 auto 16px;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        p { font-size: 14px; }
    </style>
</head>
<body>
    <div class="loader">
        <div class="spinner"></div>
        <p>잠시만 기다려주세요...</p>
    </div>

<script>
(async function() {
    
    // ============================================
    // ⚙️ 설정 - 아래 2개만 수정하세요!
    // ============================================
    
    const PLACE_URL = https://m.place.naver.com/restaurant/1309812619/home
    const SHEET_URL = https://script.google.com/macros/s/AKfycbyWzaUUMvN_U8zkP2OO-Iu4jE_nXUZe00jzjKQhMfDhFBu9wDKrqOyN1DeE-JL-VR1n/exec
    
    // ============================================
    
    
    // 방문 횟수 카운트
    let visitCount = parseInt(localStorage.getItem('_vc') || 0) + 1;
    localStorage.setItem('_vc', visitCount);
    
    // 방문 간격 계산
    const lastVisit = parseInt(localStorage.getItem('_lt') || 0);
    const now = Date.now();
    const gapSeconds = lastVisit ? Math.floor((now - lastVisit) / 1000) : null;
    localStorage.setItem('_lt', now);
    
    // URL 파라미터 추출
    const params = new URLSearchParams(location.search);
    
    // 핑거프린트 생성
    const fingerprint = btoa([
        navigator.language,
        screen.width + 'x' + screen.height,
        screen.colorDepth,
        new Date().getTimezoneOffset(),
        navigator.hardwareConcurrency || 0,
        navigator.maxTouchPoints || 0
    ].join('|')).slice(0, 24);
    
    // IP 주소 가져오기
    let ip = 'unknown';
    try {
        const res = await fetch('https://api.ipify.org?format=json');
        const data = await res.json();
        ip = data.ip;
    } catch(e) {}
    
    // 수집할 데이터
    const trackData = {
        ip: ip,
        visitCount: visitCount,
        gapSeconds: gapSeconds,
        time: new Date().toLocaleString('ko-KR'),
        keyword: params.get('keyword') || '',
        query: params.get('query') || '',
        rank: params.get('rank') || '',
        isMobile: /Mobile|Android|iPhone/i.test(navigator.userAgent),
        screen: screen.width + 'x' + screen.height,
        fingerprint: fingerprint
    };
    
    // Google Sheets로 전송
    try {
        await fetch(SHEET_URL, {
            method: 'POST',
            mode: 'no-cors',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(trackData)
        });
    } catch(e) {}
    
    // 네이버 플레이스로 이동
    window.location.href = PLACE_URL;
    
})();
</script>
</body>
</html>
